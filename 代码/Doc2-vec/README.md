# Code folder introduction


## Dissertationcode folder

We use Query2vec framework to apply query log extraction, workload analysis and query recommendation 
on WSA.
First we use Doc2vec model to vectorize all the queries in the log,
then use the K-means++ algorithm to cluster learned query vectors 
that represents each query in corpus.
 The pre-defined cluster number (K) is the determined by using Elbow method and silhouette coefficient method.  
After classification, the T-SNE algorithm
are used to reduce the dimensions of the high-dimensional vectors representing the queries and 
expressed by a two-dimensional scatter plot to show the patterns among queries.

Simple skeleton classifier model is on the basis of overlap among queries clauses. It also can perform query log extraction,
workload analysis task and query recommendation (based on the similarity in queries clauses'feature set using Jaccard 
coefficient formula)


### Python Files Description
First we describe basic information about python script files that implement Query2vec model.
#### Extract.py

A parser for format query, preprocess the query, tokenize queries 
and extract query tokens in different clauses .


#### Doc2vecTrain.py

Preprocess the queries data and bring pre-processed cprpus into Doc2vec(vectorization part) 
to get the representative high-dimensional query vector. 
Afterwards, cluster high-dimensional vectors by K-mean++ algorithm and
 reduce the dimensionality of vectorized data by PCA 
and T-SNE to visualize it by scatterplot.

#### query2vecRecom.py

This python script file perform query recommendation task in Query2vec model. It has example test queries used
in the dissertation and will output the result to FOLDER 'QueryRecommendation'.

#### determineK.py
It implement elbow method and silhouette coefficient method to determine the cluster number in K-means++ algorithm
in Query2vec model. When Doc2vec model produced the output model of queries, load it in this file and it will perform
both two methods on models to determine cluster number.

#### findHyperParameter.py
It is used to find the best combination of hyper-parameters in Doc2vec model.

#### Query2vec.py
Overall implement of query2vec model's training process and query log extraction tasks. (Pre-process -- Vectorization -- clustering - visualization
 using T-SNE algorithm). It is also used for query log extraction.




Files below implement all the functions and task in simple skeleton classifier model.

#### serialskeletonC.py
It implements the training of simple skeleton classifier model in serial. It is also used for query log extraction.
#### ParallelSimplC.py

It implements the training of simple skeleton classifier model and query log extraction
in parallel using concurrent.future model to 
slice whole training sets. 


#### SimpleClassWorkload.py
It implements the workload of simple skeleton classifier model in parallel using concurrent.future model to 
slice whole training sets. 

#### simplerecom.py
It implements the query recommendation tasks in model. Two sample queries which is used in the dissertation is
also used in this python script file as an example.


#### workloadA.py
It implements workload summarization tasks in both two models after inputting same workload.





### Output folders and files Description
#### CirrusOutput Folder
Store latest output of jobs submitted to Cirrus back-end

#### DrawCDF Folder
Contain the output and related code to output CDF curve of the existing queries in WSA query log.

#### QuerylogExtractionResults
Contain all the results output by Query2vec model against different-sized input query log samples. Insider the folder,
there are children folders that named by the amount of query log and contain its related representative query lists
of the current input query log, its T-SNE dimension-deduction display and its doc2vec model.

#### QueryRecommendation
Contain the query recommendation results of two models. Only restore the samples shows in dissertation report.


#### TrainDoc2vecOutput
The total output during training stage of Doc2vec model, including its T-SNE dimensional deduction display using Bokeh module
which can show queries in each dots and results from the output of Elbow method and silhouette coefficient method.

 - sub folder 'determineK': store all the results that generated by using Elbow method and silhouette coefficient method to determine the best cluster number 
of the current corpus.
 - sub folder 'outputcsv': store all the train data and test data when training Doc2vec model.

 - sub folder 'outputfigure':  store all output figures of Doc2vec model, including files like 'PCA_bokeh.html', which  a figure 
 generated by the dimensionality-reduced scatter plot using the PCA algorithm through the bokeh package. The saved format is html. The figure shows the plot representing queries, centroids of clusters and the cluster tags they belong to.
 
 It also includes files like 'TSNE_bokeh.html', which is the figure that produced by dimensionality-reduced scatter plot using the T-SNE algorithm through the bokeh package.
The saved format is html. The plot in the figure has tags which has its query string, query id in the log and cluster tag it belongs to.
 
 


#### WorkloadSumOutput 
 Contain the workload summarization results of two models, consists of two folders -- 'Query2vec' folder 
  and 'SimpleClassifier' folder of which store the output results of two models respectively.
  Their Sub folders are named by the sample size of workload. 